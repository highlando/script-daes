<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Linear DAEs with Constant Coefficients | DAEs</title>
  <meta name="description" content="Script to my DAE course at the OVGU in Fall 2018 / Spring 2021" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Linear DAEs with Constant Coefficients | DAEs" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://www.janheiland.de/script-daes/" />
  
  <meta property="og:description" content="Script to my DAE course at the OVGU in Fall 2018 / Spring 2021" />
  <meta name="github-repo" content="highlando/script-daes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Linear DAEs with Constant Coefficients | DAEs" />
  
  <meta name="twitter:description" content="Script to my DAE course at the OVGU in Fall 2018 / Spring 2021" />
  

<meta name="author" content="Jan Heiland" />


<meta name="date" content="2021-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basic-definitions-and-notions.html"/>
<link rel="next" href="IV.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DAEs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#examples"><i class="fa fa-check"></i><b>1.1</b> Examples</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#why-are-daes-difficult-to-treat"><i class="fa fa-check"></i><b>1.2</b> Why are DAEs difficult to treat</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-definitions-and-notions.html"><a href="basic-definitions-and-notions.html"><i class="fa fa-check"></i><b>2</b> Basic Definitions and Notions</a><ul>
<li class="chapter" data-level="2.1" data-path="basic-definitions-and-notions.html"><a href="basic-definitions-and-notions.html#solution-concept"><i class="fa fa-check"></i><b>2.1</b> Solution Concept</a></li>
<li class="chapter" data-level="2.2" data-path="basic-definitions-and-notions.html"><a href="basic-definitions-and-notions.html#initial-conditions-and-consistency"><i class="fa fa-check"></i><b>2.2</b> Initial Conditions and Consistency</a></li>
<li class="chapter" data-level="2.3" data-path="basic-definitions-and-notions.html"><a href="basic-definitions-and-notions.html#additional-remarks"><i class="fa fa-check"></i><b>2.3</b> Additional Remarks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="III.html"><a href="III.html"><i class="fa fa-check"></i><b>3</b> Linear DAEs with Constant Coefficients</a><ul>
<li class="chapter" data-level="3.1" data-path="III.html"><a href="III.html#basic-notions-and-definitions"><i class="fa fa-check"></i><b>3.1</b> Basic Notions and Definitions</a></li>
<li class="chapter" data-level="3.2" data-path="III.html"><a href="III.html#regularity-and-solvability"><i class="fa fa-check"></i><b>3.2</b> Regularity and Solvability</a></li>
<li class="chapter" data-level="3.3" data-path="III.html"><a href="III.html#solution-to-the-n-dae-regularity-and-index-of-a-matrix-pair"><i class="fa fa-check"></i><b>3.3</b> Solution to the <em>N-DAE</em>, Regularity, and Index of a Matrix Pair</a></li>
<li class="chapter" data-level="3.4" data-path="III.html"><a href="III.html#III-ex-sols"><i class="fa fa-check"></i><b>3.4</b> Existence of Solutions</a></li>
<li class="chapter" data-level="3.5" data-path="III.html"><a href="III.html#a-variation-of-constant-formula"><i class="fa fa-check"></i><b>3.5</b> A Variation of Constant Formula</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="IV.html"><a href="IV.html"><i class="fa fa-check"></i><b>4</b> Linear DAEs with Time-varying Coefficients</a><ul>
<li class="chapter" data-level="4.1" data-path="IV.html"><a href="IV.html#a-local-canonical-form"><i class="fa fa-check"></i><b>4.1</b> A Local Canonical Form</a></li>
<li class="chapter" data-level="4.2" data-path="IV.html"><a href="IV.html#IV-Global-Canonical-Form"><i class="fa fa-check"></i><b>4.2</b> A Global Canonical Form</a></li>
<li class="chapter" data-level="4.3" data-path="IV.html"><a href="IV.html#the-strangeness-index"><i class="fa fa-check"></i><b>4.3</b> The Strangeness Index</a></li>
<li class="chapter" data-level="4.4" data-path="IV.html"><a href="IV.html#derivative-arrays"><i class="fa fa-check"></i><b>4.4</b> Derivative Arrays</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="numerical-approximation-of-daes.html"><a href="numerical-approximation-of-daes.html"><i class="fa fa-check"></i><b>5</b> Numerical Approximation of DAEs</a></li>
<li class="chapter" data-level="6" data-path="construction-and-analysis-of-rkm-for-nonlinear-daes.html"><a href="construction-and-analysis-of-rkm-for-nonlinear-daes.html"><i class="fa fa-check"></i><b>6</b> Construction and Analysis of RKM for nonlinear DAEs</a><ul>
<li class="chapter" data-level="6.1" data-path="construction-and-analysis-of-rkm-for-nonlinear-daes.html"><a href="construction-and-analysis-of-rkm-for-nonlinear-daes.html#general-rkm-for-semi-explicit-strangeness-free-daes"><i class="fa fa-check"></i><b>6.1</b> General RKM for Semi-Explicit Strangeness-free DAEs</a></li>
<li class="chapter" data-level="6.2" data-path="construction-and-analysis-of-rkm-for-nonlinear-daes.html"><a href="construction-and-analysis-of-rkm-for-nonlinear-daes.html#collocation-rkm-for-implicit-strangeness-free-daes"><i class="fa fa-check"></i><b>6.2</b> Collocation RKM for Implicit Strangeness-free DAEs</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="examples-1.html"><a href="examples-1.html"><i class="fa fa-check"></i><b>7</b> Examples</a><ul>
<li class="chapter" data-level="7.1" data-path="examples-1.html"><a href="examples-1.html#semi-discrete-navier-stokes-equations"><i class="fa fa-check"></i><b>7.1</b> Semi-discrete Navier-Stokes equations</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>8</b> Exercises</a><ul>
<li class="chapter" data-level="8.1" data-path="exercises.html"><a href="exercises.html#ii.c.1"><i class="fa fa-check"></i><b>8.1</b> II.C.1</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="numerical-analysis-and-software-overview.html"><a href="numerical-analysis-and-software-overview.html"><i class="fa fa-check"></i><b>9</b> Numerical Analysis and Software Overview</a><ul>
<li class="chapter" data-level="9.1" data-path="numerical-analysis-and-software-overview.html"><a href="numerical-analysis-and-software-overview.html#theory-rkms-and-bdf-for-daes"><i class="fa fa-check"></i><b>9.1</b> Theory: RKMs and BDF for DAEs</a></li>
<li class="chapter" data-level="9.2" data-path="numerical-analysis-and-software-overview.html"><a href="numerical-analysis-and-software-overview.html#solvers"><i class="fa fa-check"></i><b>9.2</b> Solvers</a></li>
<li class="chapter" data-level="9.3" data-path="numerical-analysis-and-software-overview.html"><a href="numerical-analysis-and-software-overview.html#software"><i class="fa fa-check"></i><b>9.3</b> Software</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DAEs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="III" class="section level1">
<h1><span class="header-section-number">3</span> Linear DAEs with Constant Coefficients</h1>
<div id="basic-notions-and-definitions" class="section level2">
<h2><span class="header-section-number">3.1</span> Basic Notions and Definitions</h2>
<p>Consider the DAE in the form
<span class="math display" id="eq:gen-lin-cc-dae">\[\begin{equation}
E \dot x (t) = Ax(t) + f(t), \tag{3.1}
\end{equation}\]</span>
where <span class="math inline">\(E\)</span>, <span class="math inline">\(A\in \mathbb R^{m,n}\)</span> and <span class="math inline">\(f\in \mathcal C(\mathbb I, \mathbb R^m)\)</span> with, possibly, an initial condition
<span class="math display" id="eq:gen-lin-cc-dae-inic">\[\begin{equation}
x(t_0) = x_0 \in \mathbb R^{n}. \tag{3.2}
\end{equation}\]</span></p>
<div class="JHSAYS">
<p>
For utmost generality, we consider the case that <span class="math inline"><span class="math inline">\(m\neq n\)</span></span>, i.e. the number of equations does not meet the number of unknowns, but we will turn to the square case of <span class="math inline"><span class="math inline">\(m=n\)</span></span> soon.
</p>
</div>
<div id="scalings-and-state-transformations" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Scalings and State Transformations</h3>
<p>One can confirm that if <span class="math inline">\(x\)</span> is a solution to <a href="III.html#eq:gen-lin-cc-dae">(3.1)</a> and <span class="math inline">\(P\in \mathbb R^{n,n}\)</span> is invertible, then <span class="math inline">\(x\)</span> is a solution to
<span class="math display">\[\begin{equation*}
PE \dot x (t) = PAx(t) + Pf(t).
\end{equation*}\]</span></p>
<div class="JHSAYS">
<p>
This is a scaling of the equations.
</p>
</div>
<p>Similarly, if <span class="math inline">\(Q\in \mathbb R^{n,n}\)</span> is invertible, then <span class="math inline">\(\tilde x := Q^{-1}x\)</span> solves</p>
<p><span class="math display">\[\begin{equation*}
E Q \dot {\tilde x} (t) = AQ \tilde x(t) + f(t).
\end{equation*}\]</span></p>
<div class="JHSAYS">
<p>
This is a state transformation of the system.
</p>
</div>
<p>Thus, when talking of solvability of <a href="III.html#eq:gen-lin-cc-dae">(3.1)</a>, one may equivalently consider any regular <span class="math inline">\(Q\in \mathbb R^{m,m}\)</span>, <span class="math inline">\(P\in \mathbb R^{m,m}\)</span> and the scaled and transformed system
<span class="math display">\[\begin{equation}
\tilde E \dot{\tilde x}(t) = \tilde A \tilde x (t) + \tilde f(t), \quad \tilde x(0) = Q^{-1}x_0,
\end{equation}\]</span>
where <span class="math inline">\(\tilde E = PEQ\)</span>, <span class="math inline">\(\tilde A = PAQ\)</span>, <span class="math inline">\(\tilde f = Pf\)</span>, and <span class="math inline">\(x=Q\tilde x\)</span>.</p>
<p>To characterize all scalings and state transformations, we define these operations as relations of matrix pairs:</p>
</div>
<div id="strong-equivalence-and-canonical-forms" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Strong Equivalence and Canonical Forms</h3>

<div class="definition">
<span id="def:matrix-pair-equivalent" class="definition"><strong>Definition 3.1  </strong></span>Two pairs of matrices <span class="math inline">\((E_1, A_1)\)</span> and <span class="math inline">\((E_2, A_2)\)</span>, with <span class="math inline">\(E_1\)</span>, <span class="math inline">\(A_1\)</span>, <span class="math inline">\(E_2\)</span>, <span class="math inline">\(A_2 \in \mathbb R^{m,n}\)</span>, are called <em>strongly equivalent</em>, if there exist regular matrices <span class="math inline">\(P\in \mathbb R^{m,m}\)</span>, <span class="math inline">\(Q\in \mathbb R^{n,n}\)</span> such that
<span class="math display">\[\begin{equation*}
E_2 = PE_1Q, \quad A_2 = PA_1Q.
\end{equation*}\]</span>
In this case, we write
<span class="math display">\[(E_1, A_1) \sim (E_2, A_2).\]</span>
</div>


<div class="lemma">
<span id="lem:strong-equivalence-RSI" class="lemma"><strong>Lemma 3.1  </strong></span>The relation <span class="math inline">\(\sim\)</span> defined in Definition <a href="III.html#def:matrix-pair-equivalent">3.1</a> defines an equivalence relation<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.
</div>


<div class="proof">
 <span class="proof"><em>Proof. </em></span> Exercise.
</div>

<p>For a given equivalence relation on a set, one can define <em>equivalence classes</em> by considering all members that are equivalent to each other as basically the same. And for each class one may choose a representative, preferably in <em>canonical form</em>, i.e. a form that, e.g.,</p>
<ol style="list-style-type: decimal">
<li>comes with an simple or characteristic representation and</li>
<li>that allows for easy determination or analysis of quantities of interest.</li>
</ol>
<div class="JHSAYS">
<p>
There can be infinitely many canonical forms. For our purposes and for the <em>strong equivalence</em> of matrix pairs, we will use the <em>Kronecker Canonical Form</em>.
</p>
</div>

<div class="theorem">
<p><span id="thm:kcf" class="theorem"><strong>Theorem 3.1  </strong></span>
Let <span class="math inline">\(E\)</span>, <span class="math inline">\(A \in \mathbb C^{m,n}\)</span>. Then there exist nonsingular matrices <span class="math inline">\(P\in \mathbb C^{m,m}\)</span>, <span class="math inline">\(Q\in \mathbb C^{n,n}\)</span> such that for all <span class="math inline">\(\lambda \in \mathbb C\)</span>
<span class="math display">\[\begin{equation*}
P(\lambda E -A)Q = 
\begin{bmatrix}
\mathcal L_{\epsilon_1} \\
&amp; \ddots \\
&amp;&amp; \mathcal L_{\epsilon_p} \\
&amp;&amp;&amp; \mathcal M_{\eta_1} \\
&amp;&amp;&amp;&amp; \ddots \\
&amp;&amp;&amp;&amp;&amp; \mathcal M_{\eta_q} \\
&amp;&amp;&amp;&amp;&amp;&amp; \mathcal J_{\rho_1} \\
&amp;&amp;&amp;&amp;&amp;&amp;&amp; \ddots \\
&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; \mathcal J_{\rho_r} \\
&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; \mathcal N_{\sigma_1} \\
&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; \ddots \\
&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; \mathcal N_{\sigma_s}
\end{bmatrix}
\end{equation*}\]</span>
Where the block entries are as follows:</p>
<ol style="list-style-type: decimal">
<li>Every entry <span class="math inline">\(\mathcal L_{\epsilon_j}\)</span> is bidiagonal of size <span class="math inline">\(\epsilon_j\times (\epsilon_j +1)\)</span>, <span class="math inline">\(\epsilon_j \in \mathbb N \cup \{0\}\)</span> of the form
<span class="math display">\[\begin{equation*}
\lambda 
\begin{bmatrix}
0 &amp; 1  \\
&amp; \ddots &amp; \ddots \\
&amp;&amp; 0 &amp; 1
\end{bmatrix}
-
\begin{bmatrix}
1 &amp; 0  \\
&amp; \ddots &amp; \ddots \\
&amp;&amp; 1 &amp; 0
\end{bmatrix}
\end{equation*}\]</span></li>
<li>Every entry <span class="math inline">\(\mathcal M_{\eta_j}\)</span> is bidiagonal of size <span class="math inline">\((\eta_j+1)\times \eta_j\)</span>, <span class="math inline">\(\eta_j \in \mathbb N \cup \{0\}\)</span> of the form
<span class="math display">\[\begin{equation*}
\lambda 
\begin{bmatrix}
1  \\
0 &amp; \ddots \\
&amp; \ddots &amp; 1 \\
&amp;&amp; 0 
\end{bmatrix}
-
\begin{bmatrix}
0  \\
1 &amp; \ddots \\
&amp; \ddots &amp; 0 \\
&amp;&amp; 1 
\end{bmatrix}
\end{equation*}\]</span></li>
<li>Every entry <span class="math inline">\(\mathcal J_{\rho_j}\)</span> is a Jordan block of size <span class="math inline">\(\rho_j\times \rho_j\)</span>, <span class="math inline">\(\rho_j \in \mathbb N \setminus \{0\}\)</span>, <span class="math inline">\(\lambda_j \in \mathbb C\)</span> of the form
<span class="math display">\[\begin{equation*}
\lambda 
\begin{bmatrix}
1  \\
&amp; \ddots \\
&amp;&amp;\ddots  \\
&amp;&amp;&amp; 1 
\end{bmatrix}
-
\begin{bmatrix}
\lambda_j &amp; 1 \\
&amp; \ddots &amp; \ddots \\
&amp;&amp;&amp; 1 \\
&amp;&amp;&amp; \lambda_j 
\end{bmatrix}
\end{equation*}\]</span></li>
<li>Every entry <span class="math inline">\(\mathcal N_{\sigma_j}\)</span> is a nilpotent block of size <span class="math inline">\(\sigma_j\times \sigma_j\)</span>, <span class="math inline">\(\sigma_j \in \mathbb N \setminus \{0\}\)</span>, of the form
<span class="math display">\[\begin{equation*}
\lambda 
\begin{bmatrix}
0 &amp;1\\
&amp; \ddots &amp; \ddots \\
&amp;&amp;&amp; 1  \\
&amp;&amp;&amp; 0 
\end{bmatrix}
-
\begin{bmatrix}
1 \\
&amp; \ddots  \\
&amp;&amp;&amp;  \\
&amp;&amp;&amp;&amp; 1 
\end{bmatrix}
\end{equation*}\]</span></li>
</ol>
The <em>Kronecker Canonical Form</em> is uniquely defined up to permutations of the blocks.
</div>


<div class="proof">
 <span class="proof"><em>Proof. </em></span> Very technical. Can be found, e.g., in the book: Gantmacher (1959) <em>The Theory of Matrices II</em>.
</div>

<p>Algorithm for computations exist<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> but the computation is notoriously ill posed.</p>
</div>
</div>
<div id="regularity-and-solvability" class="section level2">
<h2><span class="header-section-number">3.2</span> Regularity and Solvability</h2>
<p>In what follows we will consider the regular case with, among others, <span class="math inline">\(E\)</span> and <span class="math inline">\(A\)</span> as square matrices.</p>
<div class="JHSAYS">
<p>
Like for solving general equation systems, one can expect well posedness for the case that the numbers of equations equals the number of unknowns. Here <em>squareness</em> of the system is a necessary condition. For sufficiency one further needs that there are no redundant equations or incompatible equations. This is encoded in the <em>regularity</em>.
</p>
</div>

<div class="definition">
<span id="def:regularity" class="definition"><strong>Definition 3.2  </strong></span>Let <span class="math inline">\(E\)</span>, <span class="math inline">\(A \in \mathbb C^{n,n}\)</span>. The matrix pair <span class="math inline">\((E, A)\)</span> is called <em>regular</em>, if the <em>characteristic polynomial</em> <span class="math inline">\(p\)</span>, defined via
<span class="math display">\[
p(\lambda) = \det (\lambda E- A),
\]</span>
is not identically zero. If such a matrix pair is not regular, it is called <em>singular</em>.
</div>

<div class="JHSAYS">
<p>
<em>Is not identically zero</em> means that there exists a <span class="math inline"><span class="math inline">\(\lambda_0\)</span></span> such that <span class="math inline"><span class="math inline">\(p(\lambda_0)=\det (\lambda_0 E - A) \neq 0\)</span></span>, i.e. <span class="math inline"><span class="math inline">\(\lambda_0 E - A\)</span></span> is invertible.
</p>
</div>
<div class="JHSAYS">
<p>
Since a characteristic polynomial has but a finite numbers of roots (unless it is the <em>zero polynomial</em>), <em>is not identically zero</em> means that <span class="math inline"><span class="math inline">\(p(\lambda) \neq 0\)</span></span> for all but a few <span class="math inline"><span class="math inline">\(\lambda\)</span></span>.
</p>
</div>
<p>Next we show, that <em>regularity</em> is invariant under <em>strong equivalence</em>. This is needed, since we will translate regularity of <span class="math inline">\((E,A)\)</span> to regularity of the associated DAE and we need to ensure that regular scalings and state transformations do not affect regularity.</p>

<div class="lemma">
<span id="lem:invariance-regularity" class="lemma"><strong>Lemma 3.2  </strong></span>Let <span class="math inline">\(E\)</span>, <span class="math inline">\(A \in \mathbb C^{n,n}\)</span>. If <span class="math inline">\((E, A)\)</span> is strongly equivalent to a regular matrix pair, then <span class="math inline">\((E, A)\)</span> is regular.
</div>


<div class="proof">
 <span class="proof"><em>Proof. </em></span> Let <span class="math inline">\(E_1\)</span>, <span class="math inline">\(A_1 \in \mathbb C^{n, n}\)</span> be similar to <span class="math inline">\((E, A)\)</span>. By definition, there exist invertible <span class="math inline">\(P\)</span>, <span class="math inline">\(Q\in \mathbb C^{n,n}\)</span> such that <span class="math inline">\(\lambda E - A = P(\lambda E_1 -A_1)Q\)</span> for all <span class="math inline">\(\lambda\)</span>. Thus,
<span class="math display">\[
\det (\lambda E - A) = \det P \det (\lambda E_1 - A_1) \det Q
\]</span>
is not identically zero, since <span class="math inline">\(\det Q\)</span> and <span class="math inline">\(\det P\)</span> are not zero and <span class="math inline">\(\det (\lambda E_1 - A_1)\)</span> is not the zero polynomial.
</div>

<p>With that we can derive a <em>canonical form</em> for <em>strongly equivalent</em> matrix pairs.</p>

<div class="theorem">
<p><span id="thm:weierstrass-cf" class="theorem"><strong>Theorem 3.2  </strong></span>Let <span class="math inline">\(E\)</span>, <span class="math inline">\(A \in \mathbb C^{n,n}\)</span> and <span class="math inline">\((E,A)\)</span> be regular. Then
<span class="math display" id="eq:weierstrass-cf">\[\begin{equation}
(E, A) \sim 
\left (
\begin{bmatrix}
I_{n_1} \\
&amp; N
\end{bmatrix}
,
\begin{bmatrix}
J \\
&amp; I_{n_2}
\end{bmatrix}
\right ),
\tag{3.3}
\end{equation}\]</span></p>
<ul>
<li>where <span class="math inline">\(n_1\)</span>, <span class="math inline">\(n_2 \in \mathbb N\)</span> such that <span class="math inline">\(n=n_1+n_2\)</span>,</li>
<li>where <span class="math inline">\(I_{n_1}\)</span> and <span class="math inline">\(I_{n_2}\)</span> denote the identity matrices of size <span class="math inline">\(n_1\times n_1\)</span> and <span class="math inline">\(n_2\times n_2\)</span>, respectively,</li>
<li>where <span class="math inline">\(J\in \mathbb C^{n_1,n_1}\)</span> is in <em>Jordan canonical form</em>,</li>
<li>and where <span class="math inline">\(N \in \mathbb C^{n_2,n_2}\)</span> is a <a href="III.html#def:nilpotent-matrix"><em>nilpotent</em> matrix</a>.</li>
<li>Moreover, it is allowed that the one or the other block is not present, i.e., <span class="math inline">\(n_1\)</span> or <span class="math inline">\(n_2\)</span> can be zero.</li>
</ul>
</div>


<div class="proof">
 <span class="proof"><em>Proof. </em></span> To be provided.
</div>

<p>Recall that the <em>Jordan canonical form</em> can be achieved for any square matrix <span class="math inline">\(M\in \mathbb C\)</span> by a similarity transformation.</p>

<div class="definition">
<span id="def:nilpotent-matrix" class="definition"><strong>Definition 3.3  (Nilpotent Matrix)  </strong></span>A matrix <span class="math inline">\(M\in \mathbb C^{n,n}\)</span> is called <em>nilpotent</em>, if there is an integer <span class="math inline">\(k\)</span> such that <span class="math inline">\(M^k=0\)</span>. The smallest such integer <em>index</em>, i.e. that <span class="math inline">\(\nu \in \mathbb N\)</span> such that <span class="math inline">\(N^\nu=0\)</span> whereas <span class="math inline">\(N^{\nu-1} \neq 0\)</span> is called the <em>index of nilpotency</em> of <span class="math inline">\(M\)</span>.
</div>

<div class="JHSAYS">
<p>
With the convention that <span class="math inline"><span class="math inline">\(\mathbf 0^0=I\)</span></span>, the zero matrix <span class="math inline"><span class="math inline">\(\mathbf 0 \in \mathbb R^{n,n}\)</span></span> is of (nilpotency) index 1.
</p>
</div>
<p>The relation of solvability and regularity of DAEs becomes evident in the canonical form of Theorem <a href="III.html#thm:weierstrass-cf">3.2</a>. In fact, it states that through regular scalings and state transforms, any DAE with</p>
<p><span class="math display">\[
E\dot x(t) =  A x(t) + f(t)
\]</span></p>
<p>with <span class="math inline">\((E,A)\)</span> regular can be transformed and split into
<span class="math display" id="eq:reg-dae-wcf-diffpart">\[\begin{equation}
\dot x_1(t) = x_1(t) + f_1(t) \tag{3.4}
\end{equation}\]</span>
and
<span class="math display" id="eq:reg-dae-wcf-algpart">\[\begin{equation}
N \dot x_2(t) = x_2(t) + f_2(t) \tag{3.5},
\end{equation}\]</span></p>
<p>i.e</p>
<ul>
<li>into an <strong>ODE</strong> <a href="III.html#eq:reg-dae-wcf-diffpart">(3.4)</a> that already is in <em>Jordan canonical form</em></li>
<li>and a separated(!) <strong>DAE</strong> <a href="III.html#eq:reg-dae-wcf-algpart">(3.5)</a> of a particular type.</li>
</ul>
<p>Since linear ODEs always have a unique solution for any initial value, solvability of a general linear DAE with constant, regular coefficients will be completely defined by solvability of the special DAE part <a href="III.html#eq:reg-dae-wcf-algpart">(3.5)</a>.</p>
</div>
<div id="solution-to-the-n-dae-regularity-and-index-of-a-matrix-pair" class="section level2">
<h2><span class="header-section-number">3.3</span> Solution to the <em>N-DAE</em>, Regularity, and Index of a Matrix Pair</h2>
<p>In what follows we will consider the special DAE
<span class="math display" id="eq:ndae">\[\begin{equation}
N \dot x(t) = x(t) + f(t) \tag{3.6}
\end{equation}\]</span>
with <span class="math inline">\(N \in \mathbb R^{n,n}\)</span> nilpotent with <span class="math inline">\(\nu\)</span> being the <a href="III.html#def:nilpotent-matrix">index of nilpotency</a>.
For this DAE there is an explicit solution formula:</p>

<div class="lemma">
<span id="lem:ndae-explicit-solution" class="lemma"><strong>Lemma 3.3  </strong></span>Consider <a href="III.html#eq:ndae">(3.6)</a>. If <span class="math inline">\(f \in \mathcal C^\nu(\mathcal I, \mathbb R^{n})\)</span>, <span class="math inline">\(n\geq 1\)</span>, where <span class="math inline">\(\nu\)</span> is the index of nilpotency of <span class="math inline">\(N\)</span>, then <a href="III.html#eq:ndae">(3.6)</a> has a unique solution given as
<span class="math display" id="eq:iii-ndae-exp-solution">\[\begin{equation}
x(t) = - \sum_{i=0}^{\nu-1}N^if^{(i)}(t), \tag{3.7}
\end{equation}\]</span>
where <span class="math inline">\(f^{(i)}\)</span> denotes the <span class="math inline">\(i\)</span>-th derivative of <span class="math inline">\(f\)</span>.
</div>


<div class="proof">
<p> <span class="proof"><em>Proof. </em></span> There are a few ways to prove the explicit form <a href="III.html#eq:iii-ndae-exp-solution">(3.7)</a></p>
<ol style="list-style-type: decimal">
<li><p>Bring <span class="math inline">\(N\)</span> into Jordan canonical form and prove the formula for the Jordan blocks of arbitrary size by induction.</p></li>
<li><p>Write <a href="III.html#eq:ndae">(3.6)</a> as <span class="math display">\[(N\frac{d}{dt}-I)x = f\]</span> and show that<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> <span class="math display">\[(N\frac{d}{dt}-I)^{-1} = - \sum_{i=0}^{\nu-1}N^i\frac{d^i}{dt^i}\]</span>.</p></li>
<li><p>We take the direct approach as it can be found in the book by Dai<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>:</p></li>
</ol>
<p>Firstly, we observe that
<span class="math display">\[
x = N\dot x - f.
\]</span>
Secondly, that (having multiplied by <span class="math inline">\(N\)</span> and differentiated once)
<span class="math display">\[
N\dot x = N^2 \ddot x - N \dot f.
\]</span>
And, finally, that (having muliplied <span class="math inline">\(k\)</span>-times by <span class="math inline">\(N\)</span> and differentiated <span class="math inline">\(k\)</span>-times)
<span class="math display">\[
N^k\dot x^{(k)} = N^{k+1} \dot x^{(k+1)} - N^k \dot f^{(k)}.
\]</span>
<!--
and that (since $N^\nu=0$)
$$
N^{\nu-1} \dot x^{(\nu-1)} = - N^\nu \dot f^{(\nu-1)}.
$$
-->
If one successively replaces <span class="math inline">\(N^kx^{(k)}=N^{k+1}x^{(k+1)}-N^kf^{(k)}\)</span>, <span class="math inline">\(k=1,2,...,\nu-1\)</span> in
<span class="math display">\[
x=N\dot x -f = N^2\ddot x - N\dot f -f = \dots = N^\nu x^{(\nu)} - \sum_{i=0}^{\nu-1} N^if^{(i)},
\]</span>
with <span class="math inline">\(N^\nu=0\)</span>, one arrives at formula <a href="III.html#eq:iii-ndae-exp-solution">(3.7)</a>.</p>
Since this construction holds for any solution, uniqueness is guaranteed too.
</div>

<div class="JHSAYS">
<p>
We make three important observations here.
</p>
</div>
<ol style="list-style-type: decimal">
<li><p>The solution <span class="math inline">\(x\)</span> to <a href="III.html#eq:ndae">(3.6)</a> is uniquely defined without specifying a value at <span class="math inline">\(t_0\)</span>. Vice versa, an initial value <span class="math inline">\(x_0\)</span> is consistent if, and only if,
<span class="math display">\[
x_0 = - \sum_{i=0}^{\nu-1}N^if^{(i)}(t_0)
\]</span></p></li>
<li><p>The definition of the solution <span class="math inline">\(x\)</span> requires <span class="math inline">\(f\)</span> to be <span class="math inline">\(\nu-1\)</span>-times differentiable. In order to be a solution according to Definition <a href="basic-definitions-and-notions.html#def:dae-solution">2.1</a>, the function <span class="math inline">\(x\)</span> itself has to be differentiable too. Hence the requirement <span class="math inline">\(f \in \mathcal C^\nu(\mathcal I, \mathbb R^{n})\)</span>.</p></li>
<li><p>The index of nilpotency of <span class="math inline">\(N\)</span> defines the necessary smoothness of the right hand side.</p></li>
</ol>
<div class="JHSAYS">
<p>
The index of nilpotency in the <span class="math inline"><span class="math inline">\(N\)</span></span> part of the <a href="III.html#eq:weierstrass-cf">Weierstrass canonical form</a> is characteristic for a matrix pair and defines an <em>index</em> of the associated DAE.
</p>
</div>

<div class="definition">
<span id="def:matrix-pair-index" class="definition"><strong>Definition 3.4  </strong></span>Consider a regular matrix pair <span class="math inline">\((E, A)\)</span> and its Weierstrass canonical form, i.e.
<span class="math display">\[
(E, A) \sim 
\left (
\begin{bmatrix}
I_{n_1} \\
&amp; N
\end{bmatrix}
,
\begin{bmatrix}
J \\
&amp; I_{n_2}
\end{bmatrix}
\right ).
\]</span>
The index <span class="math inline">\(\nu\)</span> of nilpotency of <span class="math inline">\(N\)</span> is called the index of the matrix pair <span class="math inline">\((E, A)\)</span> and we write <span class="math inline">\(\nu = \operatorname{ind}(E, A)\)</span>. If <span class="math inline">\(N\)</span> is not present, then we set <span class="math inline">\(\operatorname{ind}(E,A)=0\)</span>.
</div>

<div class="JHSAYS">
<p>
Furthermore, for a nilpotent matrix <span class="math inline"><span class="math inline">\(N\)</span></span>, we will occasionally use the notion <span class="math inline"><span class="math inline">\(\nu=\operatorname{ind}(N,I)\)</span></span> to refer to its index of nilpotency. <strong>X</strong>: Is this OK, i.e. consistent?
</p>
</div>
<p>To be on the safe side and to learn how to handle block structured matrices in the analysis, we confirm that this definition of the index is well-posed, i.e. for any regular matrix <span class="math inline">\((E,A)\)</span> there is a unique index <span class="math inline">\(\nu\)</span>.</p>
<div class="JHSAYS">
<p>
If one considers the Weierstrass canonical form as a special case of the <a href="III.html#thm:kcf">Kronecker canonical form</a>, then the statement that <em>the canonical form is well-posed up to permutations in the order of the blocks</em> already implies that the index is well defined (since it only depends on the size of the largest nilpotent block but not in which order it appears).
</p>
</div>

<div class="lemma">
<span id="lem:kronecker-index-well-defined" class="lemma"><strong>Lemma 3.4  </strong></span>Suppose that the regular matrix pair <span class="math inline">\((E, A)\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(A\in \mathbb R^{n,n}\)</span> has the two canonical forms
<span class="math display">\[
(E, A) \sim 
\left (
\begin{bmatrix}
I_{d_1} \\
&amp; N_1
\end{bmatrix}
,
\begin{bmatrix}
J_1 \\
&amp; I_{n-d_1}
\end{bmatrix}
\right )
\sim 
\left (
\begin{bmatrix}
I_{d_2} \\
&amp; N_2
\end{bmatrix}
,
\begin{bmatrix}
J_2 \\
&amp; I_{n-d_2}
\end{bmatrix}
\right ),
\]</span>
where <span class="math inline">\(d_1\)</span>, <span class="math inline">\(d_2\)</span> are the size of the Jordan blocks <span class="math inline">\(J_1\)</span>, <span class="math inline">\(J_2\)</span>, respectively. Then <span class="math inline">\(d_1=d_2=:d\)</span> and the indices of nilpotency of the nilpotent blocks coincide, i.e. <span class="math inline">\(\operatorname{ind}(N_1, I_{n-d}) = \operatorname{ind}(N_2, I_{n-d})\)</span>.
</div>


<div class="proof">
<p> <span class="proof"><em>Proof. </em></span> To show that <span class="math inline">\(d_1=d_2\)</span>, without loss of generality, we can assume that <span class="math inline">\(N_i\)</span> are in Jordan form too. This, in particular, means that they are upper triangular with zeros on the diagonal. (If this was not the case, we can use <span class="math inline">\(N_i = T^{-1}\tilde N_i T\)</span> in the arguments below).</p>
<p>Then, we have that the characteristic polynomials
<span class="math display">\[
\det (\lambda E - A) = \det (\lambda N_i-I_{n-d_i})\det (\lambda I_{d_i} - J_i) = (-1)^{n-d_i}\det (\lambda I_{d_i} - J_i)
\]</span>
are polynomials of degree <span class="math inline">\(d_i\)</span>, <span class="math inline">\(i=1,2\)</span>.</p>
<p>Since the characteristic polynomials of strongly equivalent matrix pairs only differ by a constant factor (see the proof of Lemma <a href="III.html#lem:invariance-regularity">3.2</a>), this implies that <span class="math inline">\(d_1=d_2\)</span>.</p>
<p>Now we show, that the indices of nilpotency of <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_2\)</span> coincide. If the <span class="math inline">\(N\)</span>-blocks weren’t present, there would be nothing to show. So let’s assume that they are there.</p>
<p>Let now be <span class="math inline">\(P\)</span>, <span class="math inline">\(Q \in \mathbb R^{n,n}\)</span> that invertible matrices that realize the strong equivalence of the canonical forms, i.e.
<span class="math display" id="eq:equiv-wcf-i">\[\begin{equation}
\tag{3.8}
\begin{bmatrix}
P_{11} &amp; P_{12} \\
P_{21} &amp; P_{22}
\end{bmatrix}
\begin{bmatrix}
I \\
&amp; N_2
\end{bmatrix}
=
\begin{bmatrix}
I \\
&amp; N_1 
\end{bmatrix}
\begin{bmatrix}
Q_{11} &amp; Q_{12} \\
Q_{21} &amp; Q_{22}
\end{bmatrix}
\end{equation}\]</span>
and
<span class="math display" id="eq:equiv-wcf-ii">\[\begin{equation}
\tag{3.9}
\begin{bmatrix}
P_{11} &amp; P_{12} \\
P_{21} &amp; P_{22}
\end{bmatrix}
\begin{bmatrix}
J_2 \\
&amp; I 
\end{bmatrix}
=
\begin{bmatrix}
J_1 \\
&amp; I 
\end{bmatrix}
\begin{bmatrix}
Q_{11} &amp; Q_{12} \\
Q_{21} &amp; Q_{22}
\end{bmatrix},
\end{equation}\]</span>
where <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span> have been partitioned in line with the canonical forms.</p>
<p>Taking the blockwise matrix product and equating the blocks separately, the following relations are obtained:</p>
<table style="width:100%;">
<colgroup>
<col width="13%" />
<col width="21%" />
<col width="21%" />
<col width="21%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th>Block:</th>
<th align="center">(1,1)</th>
<th align="center">(1,2)</th>
<th align="center">(2,1)</th>
<th align="center">(2,2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="III.html#eq:equiv-wcf-i">(3.8)</a>:</td>
<td align="center"><span class="math inline">\(P_{11}=Q_{11}\)</span></td>
<td align="center"><span class="math inline">\(P_{12}N_2=Q_{12}\)</span></td>
<td align="center"><span class="math inline">\(P_{21}=N_1Q_{21}\)</span></td>
<td align="center"><span class="math inline">\(P_{22}N_2=N_1Q_{22}\)</span></td>
</tr>
<tr class="even">
<td><a href="III.html#eq:equiv-wcf-ii">(3.9)</a>:</td>
<td align="center"><span class="math inline">\(P_{11}J_2=J_1Q_{11}\)</span></td>
<td align="center"><span class="math inline">\(P_{12}=J_1Q_{12}\)</span></td>
<td align="center"><span class="math inline">\(P_{21}J_2=Q_{21}\)</span></td>
<td align="center"><span class="math inline">\(P_{22}=Q_{22}\)</span></td>
</tr>
</tbody>
</table>
<p>If we combine the <strong>(2,1)</strong> blocks, we obtain that
<span class="math display">\[
P_{21}=N_1Q_{21}=N_1P_{21}J_2=N_1^2P_{21}J_2^2=N_1^3P_{21}J_2^3=\dotsc=0
\]</span>
since <span class="math inline">\(N_1\)</span> is nilpotent.</p>
Since <span class="math inline">\(P\)</span> is invertible and, because of <span class="math inline">\(P_{21}=0\)</span>, block upper triangular, the blocks on the diagonals <span class="math inline">\(P_{11}\)</span> and <span class="math inline">\(P_{22}\)</span> must be invertible. With <span class="math inline">\(Q_{22}=P_{22}\)</span> the <strong>(2,2)</strong> block of <a href="III.html#eq:equiv-wcf-i">(3.8)</a> implies that
<span class="math display">\[
N_2 = P_{22}^{-1}N_1P_{22}
\]</span>
and, further,
<span class="math display">\[
N_2^k = P_{22}^{-1}N_1^kP_{22}
\]</span>
for all <span class="math inline">\(k\in\mathbb N\)</span>. So that a power <span class="math inline">\(N_2^k=0\)</span> if, and only if, <span class="math inline">\(N_1^k=0\)</span>. Consequently, the indices of nilpotency of <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_2\)</span> coincide.
</div>

</div>
<div id="III-ex-sols" class="section level2">
<h2><span class="header-section-number">3.4</span> Existence of Solutions</h2>
<div class="JHSAYS">
<p>
We can now summarize all results and considerations in a theorem.
</p>
</div>

<div class="theorem">
<p><span id="thm:regularity-means-solvability" class="theorem"><strong>Theorem 3.3  </strong></span>
Consider the DAE <a href="III.html#eq:gen-lin-cc-dae">(3.1)</a> with initial condition <a href="III.html#eq:gen-lin-cc-dae-inic">(3.2)</a>,
<span class="math display">\[
E \dot x (t) = Ax(t) + f(t), \quad x(t_0) = x_0 \in \mathbb R^{n}.
\]</span>
Let the pair <span class="math inline">\((E, A)\)</span> be <a href="#lem:regularity">regular</a> and consider the strongly equivalent DAE
<span class="math display">\[
\tilde E \dot {\tilde x} (t) = \tilde A\tilde x(t) + \tilde f(t), \quad \tilde x(t_0) = \tilde x_0 \in \mathbb R^{n}.
\]</span>
with <span class="math inline">\((\tilde E,\tilde A)\)</span> in Weierstrass canonical form, i.e.
<span class="math display">\[
\tilde E = 
\begin{bmatrix}
I &amp; 0 \\  0 &amp;N 
\end{bmatrix}, 
\quad 
\tilde A = 
\begin{bmatrix}
J &amp; 0 \\  0 &amp;I 
\end{bmatrix}, 
\]</span>
and consider the conforming splitting of the transformed variables
<span class="math display">\[
\tilde x = 
\begin{bmatrix}
\tilde x_1 \\ \tilde x_2
\end{bmatrix},
\quad
\tilde x_0 = 
\begin{bmatrix}
\tilde x_{0,1} \\ \tilde x_{0,2}
\end{bmatrix}.
\]</span>
Furthermore, let <span class="math inline">\(\nu\)</span> be the index of the matrix pair <span class="math inline">\((E,A)\)</span>.</p>
<p>If <span class="math inline">\(f\in \mathcal C^\nu(\mathcal I,\mathbb C^{n})\)</span>, then</p>
<ol style="list-style-type: decimal">
<li><p>The differential algebraic equation <a href="III.html#eq:gen-lin-cc-dae">(3.1)</a> is solvable.</p></li>
<li><p>The initial condition <span class="math inline">\(x_0\)</span> in <a href="III.html#eq:gen-lin-cc-dae-inic">(3.2)</a> is consistent if, and only if, for the transformed initial condition <span class="math inline">\(\tilde x_0\)</span> it holds that
<span class="math display">\[
  \tilde x_{2,0} = - \sum_{i=0}^{\nu-1}N^i\tilde f^{(i)}(t_0)
\]</span>
In particular, a consistent initial condition to <a href="III.html#eq:gen-lin-cc-dae">(3.1)</a> exists.</p></li>
<li>Every initial value problem <a href="III.html#eq:gen-lin-cc-dae">(3.1)</a>–<a href="III.html#eq:gen-lin-cc-dae-inic">(3.2)</a> with a consistent initial condition is uniquely solvable.</li>
</ol>
</div>


<div class="proof">
 <span class="proof"><em>Proof. </em></span> A summary of the preceding results.
</div>

<p>From Theorem <a href="III.html#thm:regularity-means-solvability">3.3</a> it follows that the regularity of the matrix pair <span class="math inline">\((E, A)\)</span> implies the existence of a unique solution to the DAE <a href="III.html#eq:gen-lin-cc-dae">(3.1)</a> with an initial condition <a href="III.html#eq:gen-lin-cc-dae-inic">(3.2)</a> provided that the initial condition is consistent.</p>
<div class="JHSAYS">
<p>
The negation of this statement is a bit diffuse because there are several things that <em>can go wrong</em> if the DAE is not regular. Depending on the irregularity there might be infinite many solutions to the initial value problem or no solutions at all to the DAE (even without the initial condition).
</p>
</div>
<p>The following theorem covers the case of singular or non-square matrix pairs.</p>

<div class="theorem">
<p><span id="thm:unnamed-chunk-22" class="theorem"><strong>Theorem 3.4  (Thm. 2.14 in <em>Kunkel/Mehrmann</em>)  </strong></span>Let <span class="math inline">\(E\)</span>, <span class="math inline">\(A\in \mathbb C^{m,n}\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>If <span class="math inline">\(\operatorname{rank}(\lambda E -A) &lt; n\)</span> for all <span class="math inline">\(\lambda \in \mathbb C\)</span>, then the <em>homogeneous</em> initial value problem
<span class="math display">\[ 
E\dot x(t) = Ax(t), \quad x(t_0) = 0, 
\]</span>
has a nontrivial solution.</p></li>
<li>If <span class="math inline">\(\operatorname{rank}(\lambda E -A) &lt; m\)</span> for all <span class="math inline">\(\lambda\in \mathbb C\)</span>, then there exist arbitrarily smooth inhomogeneities <span class="math inline">\(f\)</span> for which the DAE <a href="III.html#eq:gen-lin-cc-dae">(3.1)</a>
<span class="math display">\[ 
E\dot x(t) = Ax(t)+f(t),
\]</span>
is not solvable.</li>
</ol>
</div>


<div class="proof">
 <span class="proof"><em>Proof. </em></span> The proof is given for Theorem 2.14 in <em>Kunkel/Mehrmann</em> with, however, the second claim being formulated slightly differently. To reduce our formulation to <em>theirs</em>, one may identify that columns of <span class="math inline">\(\lambda E - A\)</span> that achieve the maximal rank and split off the redundant columns, e.g., the parts of <span class="math inline">\(x\)</span> associated with them.
</div>

<p>Note that a nontrivial solution to the <em>homogeneous</em> problem, means that existence of <strong>a</strong> solution implies <strong>infinitely many</strong> solutions to the initial value problem. In fact, if <span class="math inline">\(x_h\)</span> is the solution to the homogeneous problem and <span class="math inline">\(x_p\)</span> a solution<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> to the initial value problem, then <span class="math inline">\(x = x_p + \alpha x_h\)</span> solves the initial value problem for any <span class="math inline">\(\alpha \in \mathbb R\)</span>.</p>
<p>To illustrate the difficulties with singular or non-square DAEs, consider the example
<span class="math display">\[
\begin{bmatrix}
0 &amp; 1 &amp; \\
&amp;&amp; 1  \\
&amp;&amp; 0  \\
\end{bmatrix}
\frac{d}{dt}
\begin{bmatrix}
x_1 \\ x_2 \\ x_3
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 0 &amp; \\
&amp;&amp; 0  \\
&amp;&amp; 1  \\
\end{bmatrix}
\begin{bmatrix}
x_1 \\ x_2 \\ x_3
\end{bmatrix}
+
\begin{bmatrix}
0 \\ f_2 \\ f_3
\end{bmatrix}
\]</span>
Here, the first part reads
<span class="math display">\[
x_1 = \dot x_2
\]</span>
which defines a solution <span class="math inline">\(x_2=g\)</span> for any <span class="math inline">\(g \in \mathcal C^2\)</span> and a nontrivial solution to the associated <em>homogeneous</em> initial value problem if only <span class="math inline">\(g(t)\neq 0\)</span> for some <span class="math inline">\(t\)</span> but <span class="math inline">\(g(t_0)=\dot g(t_0) = 0\)</span>.</p>
<p>The second part reads
<span class="math display">\[\begin{align*}
\dot x_3 &amp;= f_2 \\
-x_3 &amp;= f_3
\end{align*}\]</span>
which does <strong>not</strong> permit a solution, if <span class="math inline">\({\dot{f}}_3 \neq f_2\)</span>.</p>
<div class="JHSAYS">
<p>
<strong>X</strong>: find such a <span class="math inline"><span class="math inline">\(g\)</span></span> for the first part.
</p>
</div>
</div>
<div id="a-variation-of-constant-formula" class="section level2">
<h2><span class="header-section-number">3.5</span> A Variation of Constant Formula</h2>
<p>In this section, we want to derive an explicit solution formula for linear DAEs with constant coefficients <span class="math inline">\(E\dot x(t) = Ax(t)+f(t)\)</span> similar to the formula that exist for linear time-invariant (i.e. with constant coefficients) ODEs.</p>
<div class="JHSAYS">
<p>
Certainly, a solution formula is given through the transformation to the Weierstrass canonical form and through <span class="citation">(<span class="citeproc-not-found" data-reference-id="ref"><strong>???</strong></span>)</span>(eq:iii-ndae-exp-solution). This however is not an explicit solution representation in so far as both the coefficients and the solution <span class="math inline"><span class="math inline">\(x\)</span></span> itself had to be undertaken a transformation first.
</p>
</div>
<div id="the-outline-for-deriving-the-explicit-formula" class="section level3 unnumbered">
<h3>The outline for deriving the explicit formula</h3>
<p>The following derivations and arguments base on two major components</p>
<ol style="list-style-type: decimal">
<li>Representation of solutions as <span class="math inline">\(x=x_h+x_p\)</span>, where
<ul>
<li><span class="math inline">\(x_h\)</span> describes all solutions to the <em>homogeneous</em> problem <span class="math inline">\(E\dot x = Ax\)</span> and</li>
<li><span class="math inline">\(x_p\)</span> denotes a (so-called <em>particular</em>) solution to <span class="math inline">\(E\dot x = Ax + f\)</span>.</li>
</ul></li>
<li>Additive splitting of DAEs into nilpotent and almost ODE parts, in the way that <span class="math inline">\(x\)</span> solves <span class="math inline">\(E\dot x = Ax+f\)</span>, if, and only if, <span class="math inline">\(x=x_1+x_2\)</span> where <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> fulfill
<ul>
<li><span class="math inline">\(\tilde C \dot x_1 = A x_1 + f_1\)</span>, with <span class="math inline">\(\tilde C\)</span> <em>almost invertible</em></li>
<li><span class="math inline">\(\tilde N \dot x_2 = A x_2 + f_2\)</span>, with <span class="math inline">\(\tilde N\)</span> nilpotent.</li>
</ul></li>
</ol>
<p>We start with defining what was meant by <em>almost invertible</em>. For that consider the differential equation
<span class="math display" id="eq:iii-sdae-edx-x">\[
E\dot x(t) = x(t), \quad x(t_0) = x_0 \tag{3.10}
\]</span>
with <span class="math inline">\(E\in \mathbb C^{n,n}\)</span>.</p>
<p>If <span class="math inline">\(E\)</span> was invertible, then the unique solution to <a href="III.html#eq:iii-sdae-edx-x">(3.10)</a> would be given as
<span class="math display">\[
x(t) = e^{(t-t_0)E^{-1}}x_0.
\]</span>
If <span class="math inline">\(E\)</span> is not invertible, then there exists a matrix <span class="math inline">\(T\in \mathbb R^{n,n}\)</span>, invertible, that brings <span class="math inline">\(E\)</span> into Jordan canonical form
<span class="math display">\[
J=TET^{-1}=
\begin{bmatrix}
C \\ &amp; N
\end{bmatrix}
\]</span>
with <span class="math inline">\(C\)</span> invertible and <span class="math inline">\(N\)</span> nilpotent so that <a href="III.html#eq:iii-sdae-edx-x">(3.10)</a> can be written
<span class="math display">\[
\begin{bmatrix}
C \\ &amp; N
\end{bmatrix}
\begin{bmatrix}
\dot x_1(t) \\ \dot x_2(t)
\end{bmatrix}
=
\begin{bmatrix}
I \\ &amp; I
\end{bmatrix}
\begin{bmatrix}
x_1(t) \\ x_2(t)
\end{bmatrix},
\quad 
\begin{bmatrix}
 x_1(t_0) \\ x_2(t_0)
\end{bmatrix}
=
\begin{bmatrix}
 x_{1,0} \\ x_{2,0}
\end{bmatrix}
=Tx_0.
\]</span></p>
<p>Since there is no right hand side, by the formula <a href="III.html#eq:iii-ndae-exp-solution">(3.7)</a> for the special DAE <span class="math inline">\(N\dot x=x+f\)</span>, we conclude that <span class="math inline">\(x_2=0\)</span>, so that only the ODE part <span class="math inline">\(C\dot x_1 = x_1\)</span> remains and the overall solution writes
<span class="math display">\[
\begin{bmatrix}
x_1(t) \\ x_2(t)
\end{bmatrix}=
\begin{bmatrix}
e^{(t-t_0)C^{-1}} \\ &amp; 0
\end{bmatrix}
\begin{bmatrix}
 x_{1,0} \\ x_{2,0}
\end{bmatrix}.
\]</span>
If we define
<span class="math display">\[
J^D = 
\begin{bmatrix}
C \\ &amp; N
\end{bmatrix}^D
:=
\begin{bmatrix}
C^{-1} \\ &amp; 0
\end{bmatrix},
\]</span>
the solution to <a href="III.html#eq:iii-sdae-edx-x">(3.10)</a> can be expressed as
<span class="math display">\[
Tx(t) = e^{(t-t_0)J^D}Tx_0
\]</span>
or with
<span class="math display">\[
E^D := TJ^{D}T^{-1}, \quad e^{(t-t_0)TJ^{D}T^{-1}} = Te^{(t-t_0)J^{D}}T^{-1}
\]</span>
as
<span class="math display">\[
x(t) = e^{(t-t_0)E^D}x_0.
\]</span></p>
<p>A few observations</p>
<ol style="list-style-type: decimal">
<li>The formula looks like the solution formula for the ODE case.</li>
<li>In fact, if <span class="math inline">\(E\)</span> is invertible, then <span class="math inline">\(E^{D}=E^{-1}\)</span> and the formulas coincide.</li>
<li>Thus, <span class="math inline">\(E^D\)</span> is a generalized inverse – the so-called <em>Drazin</em> inverse.</li>
</ol>

<div class="definition">
<p><span id="def:drazin-inverse" class="definition"><strong>Definition 3.5  </strong></span>
Let <span class="math inline">\(E\in \mathbb C^{n,n}\)</span> and <span class="math inline">\(\nu = \operatorname{ind}(E)\)</span>. A matrix <span class="math inline">\(X\in \mathbb C^{n,n}\)</span> that fulfills</p>
<p><span class="math display" id="eq:def-drazin-c" id="eq:def-drazin-b" id="eq:def-drazin-a">\[\begin{align}
    EX &amp; = XE, \tag{3.11} \\
    XEX &amp; = X, \tag{3.12} \\
    XE^{\nu+1} &amp; = E^{\nu}, \tag{3.13}
\end{align}\]</span></p>
is called a <em>Drazin inverse</em> of <span class="math inline">\(E\)</span>.
</div>

<p>With the following theorem we confirm that a Drazin inverse to a matrix <span class="math inline">\(E\)</span> is unique so that we can write <span class="math inline">\(E^D\)</span> for it.</p>

<div class="theorem">
<p><span id="thm:drazin-inverse-unique" class="theorem"><strong>Theorem 3.5  </strong></span>
Every matrix <span class="math inline">\(E\in\mathbb{C}^{n,n}\)</span> has one, and only one, Drazin inverse.</p>
</div>


<div class="proof">
<p> <span class="proof"><em>Proof. </em></span> Uniqueness: Let <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> be two Drazin inverses of <span class="math inline">\(E\)</span>. Then by repeated application of the identities in <a href="III.html#eq:def-drazin-a">(3.11)</a>–<a href="III.html#eq:def-drazin-c">(3.13)</a> one derives that</p>
<p><span class="math display">\[\begin{align*}
X_1 EX_1 E X_2 =   &amp;X_1EX_2 = X_1EX_2EX_2  \\
X_1^2 E^2 X_2 = \dotsm=   &amp;X_1EX_2 = \dotsm= X_1E^2X_2^2  \\
X_1^{\nu+1}E^{\nu+1} X_2 =\dotsm=\dotsm=   &amp;X_1EX_2 =\dotsm=\dotsm= X_1E^{\nu+1}X_2^{\nu+1}  \\
X_1^{\nu+1}E^{\nu+1} X_1 =\dotsm=\dotsm=\dotsm=   &amp;X_1EX_2 =\dotsm=\dotsm=\dotsm= X_2E^{\nu+1}X_2^{\nu+1}  \\
X_1 =\dotsm=\dotsm=\dotsm=\dotsm=   &amp;X_1EX_2 =\dotsm=\dotsm=\dotsm=\dotsm= X_2, \\
\end{align*}\]</span></p>
<p>where in the second last step we used the identities</p>
<span class="math display">\[
    E^{\nu+1}X_1=X_1E^{\nu+1}=E^{\nu}=X_2E^{\nu+1}=E^{\nu+1}X_2.
\]</span>
</div>


<div class="lemma">
<span id="lem:ae-commute-ade-commute" class="lemma"><strong>Lemma 3.5  </strong></span>Let <span class="math inline">\(E\)</span>, <span class="math inline">\(A \in \mathbb C^{n,n}\)</span> commuting, i.e. <span class="math inline">\(EA=AE\)</span>. Then also
<span class="math display" id="eq:commute-ea-ead-ade">\[\begin{equation}
EA^D = A^DE. \tag{3.14}
\end{equation}\]</span>
</div>


<div class="theorem">
<p><span id="thm:decomposition-e-cpn" class="theorem"><strong>Theorem 3.6  </strong></span>Let <span class="math inline">\(E\in \mathbb C^{n,n}\)</span> with <span class="math inline">\(\nu = \operatorname{ind}E\)</span>. Then there exists a unique decomposition
<span class="math display">\[
E=\tilde C + \tilde N
\]</span>
with the properties
<span class="math display" id="eq:tc-index-1" id="eq:tn-nilpotent" id="eq:tctn-tntc-zero">\[\begin{align}
\tilde C \tilde N = \tilde N \tilde C = 0, \tag{3.15} \\
\tilde N^\nu = 0, \quad \tilde N^{\nu-1} \neq 0, \tag{3.16}\\
\operatorname{ind}\tilde C \leq 1, \tag{3.17}
\end{align}\]</span>
and, in particular
<span class="math display" id="eq:def-tc-tn">\[\begin{align}
\tilde C = EE^DE, \quad \tilde N = E(I - E^DE). \tag{3.18}
\end{align}\]</span></p>
</div>


<div class="proof">
<p> <span class="proof"><em>Proof. </em></span> 
1. Show that such a decomposition with the properties <a href="III.html#eq:tctn-tntc-zero">(3.15)</a>-<a href="III.html#eq:tc-index-1">(3.17)</a> also fulfills <a href="III.html#eq:def-tc-tn">(3.18)</a>, i.e. existence.</p>
<ol start="2" style="list-style-type: decimal">
<li>Show that <span class="math inline">\(\tilde C\)</span>, <span class="math inline">\(\tilde N\)</span> as in <a href="III.html#eq:def-tc-tn">(3.18)</a> are such a decomposition, i.e. uniqueness.</li>
</ol>
</div>

<p>Now we can define, how the general DAE can be split <em>additively</em> into an <em>almost</em> ODE and a particular nilpotent DAE.</p>

<div class="lemma">
<span id="lem:additive-split-dae-tntc" class="lemma"><strong>Lemma 3.6  </strong></span>Let <span class="math inline">\(E\)</span>, <span class="math inline">\(A \in \mathbb C^{n,n}\)</span> and <span class="math inline">\(f\colon \mathcal I \to \mathbb C^{n}\)</span>. If <span class="math inline">\(E\)</span> and <span class="math inline">\(A\)</span> commute, then the system
<span class="math display">\[
E\dot x(t) = Ax(t) + f(t)
\]</span>
is equivalent – in the sense that solutions correspond one-to-one via <span class="math inline">\(x=x_1+x_2\)</span> – to the system
<span class="math display">\[\begin{align*}
\tilde C \dot x_1(t) &amp;= Ax_1(t) + f_1(t), \\
\tilde N \dot x_2(t) &amp;= Ax_2(t) + f_2(t), 
\end{align*}\]</span>
where
<span class="math display">\[\begin{equation}
x_1 = E^{D}Ex, \quad x_2 = (I-E^{D}E)x,
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
f_1 = E^{D}Ef, \quad f_2 = (I-E^{D}E)f,
\end{equation}\]</span>
and where
<span class="math display">\[
\tilde N + \tilde C = E
\]</span>
are a decomposition as in Theorem <a href="III.html#thm:decomposition-e-cpn">3.6</a>.
</div>

<div class="JHSAYS">
<p>
This decomposition is used to characterize <strong>all</strong> solutions to the homogeneous problem <span class="math inline"><span class="math inline">\(E\dot x = Ax\)</span></span>.
</p>
</div>

<div class="theorem">
<span id="thm:exp-formula-homogeneous-problem" class="theorem"><strong>Theorem 3.7  </strong></span>Let <span class="math inline">\(E\)</span>, <span class="math inline">\(A \in \mathbb C^{n,n}\)</span> commuting, i.e. <span class="math inline">\(EA=AE\)</span>, and let <span class="math inline">\((E,A)\)</span> be regular. Then every solution <span class="math inline">\(x\in \mathcal C^1(\mathcal I, \mathbb C^n)\)</span> of <span class="math inline">\(E\dot x=Ax\)</span> has the form
<span class="math display">\[\begin{equation}
x(t) = e^{E^DAt}E^DEv
\end{equation}\]</span>
for some <span class="math inline">\(v\in \mathbb C^n\)</span>.
</div>


<div class="proof">
<p> <span class="proof"><em>Proof. </em></span> 
1. Confirm directly that <span class="math inline">\(x\colon t \mapsto e^{E^DAt}E^DEv\)</span> satisfies <span class="math inline">\(E\dot x - Ax=0\)</span>. Note that regularity of <span class="math inline">\((E,A)\)</span> is not needed here.</p>
<ol start="2" style="list-style-type: decimal">
<li>Use regularity and the splitting to show that any solution has this form.</li>
</ol>
</div>

<div class="JHSAYS">
<p>
It remains to find <strong>a</strong> particular solution.
</p>
</div>

<div class="theorem">
<span id="thm:exp-formula-particular-solution" class="theorem"><strong>Theorem 3.8  </strong></span>Let <span class="math inline">\(E\)</span>, <span class="math inline">\(A \in \mathbb C^{n,n}\)</span> commuting, i.e. <span class="math inline">\(EA=AE\)</span>, and let <span class="math inline">\((E,A)\)</span> be regular. Let <span class="math inline">\(f\in \mathcal C^\nu(\mathcal I, \mathbb C^n)\)</span> with <span class="math inline">\(\nu = \operatorname{ind}E\)</span>. Then <span class="math inline">\(x\in \mathcal C^1(\mathcal I, \mathbb C^n)\)</span> defined by
<span class="math display">\[
x(t) = \int_{t_0}^t e^{E^DA(t-s)}E^Df(s)ds - (I-E^DE)\sum_{i=0}^{\nu-1}(EA^D)^iA^Df^{(i)}(t)
\]</span>
is a particular solution of <span class="math inline">\(E\dot x(t) = Ax(t)+f(t)\)</span>.
</div>


<div class="theorem">
<span id="thm:explicit-sol-representation" class="theorem"><strong>Theorem 3.9  </strong></span>Let <span class="math inline">\(E\)</span>, <span class="math inline">\(A \in \mathbb C^{n,n}\)</span> commuting, i.e. <span class="math inline">\(EA=AE\)</span>, and let <span class="math inline">\((E,A)\)</span> be regular. Let <span class="math inline">\(f\in \mathcal C^\nu(\mathcal I, \mathbb C^n)\)</span> with <span class="math inline">\(\nu = \operatorname{ind}E\)</span>. Then every solution <span class="math inline">\(x\in \mathcal C^1(\mathcal I, \mathbb C^n)\)</span> to <span class="math inline">\(E\dot x(t) = Ax(t)+f(t)\)</span> has the representation
<span class="math display">\[
x(t) = e^{(t-t_0)E^DA}E^DEv +\int_{t_0}^t e^{E^DA(t-s)}E^Df(s)ds - (I-E^DE)\sum_{i=0}^{\nu-1}(EA^D)^iA^Df^{(i)}(t)
\]</span>
for some <span class="math inline">\(v\in \mathbb C^n\)</span>.
</div>

<div class="JHSAYS">
<p>
This theorem also defines what is a consistent initial value.
</p>
</div>

<div class="corollary">
<span id="cor:unnamed-chunk-32" class="corollary"><strong>Corollary 3.1  </strong></span>Let the assumptions of Theorem <a href="III.html#thm:explicit-sol-representation">3.9</a> hold. The initial value problem <a href="III.html#eq:gen-lin-cc-dae">(3.1)</a>–<a href="III.html#eq:gen-lin-cc-dae-inic">(3.2)</a>,
<span class="math display">\[
E\dot x (t) = Ax(t) + f(t), \quad x(t_0)=x_0,
\]</span>
possesses a solution if, and only if, there exists a <span class="math inline">\(v\in \mathbb C^n\)</span> such that
<span class="math display">\[
x_0 = E^{D}Ev - (I-E^DE)\sum_{i=0}^{\nu-1}(EA^D)^iA^Df^{(i)}(t_0).
\]</span>
If this is the case, then the solution is unique.
</div>

<div class="JHSAYS">
<p>
We have derived the solution formula under the assumption that <span class="math inline"><span class="math inline">\(EA=AE\)</span></span> which is hardly ever the case.
</p>
</div>
<p>The following lemma states that the assumption of commutativity is not a restriction for regular matrix pairs.</p>

<div class="lemma">
<span id="lem:regular-ea-commute" class="lemma"><strong>Lemma 3.7  </strong></span>Let <span class="math inline">\((E,A)\)</span> be regular and let <span class="math inline">\(\tilde \lambda\)</span> be such that <span class="math inline">\(\tilde \lambda E - A\)</span> is invertible. Then
<span class="math display">\[\bigl (\tilde E,\tilde A\bigr ):=\bigl ( (\tilde \lambda E-A)^{-1}E, (\tilde \lambda E-A)^{-1}A \bigr )  \sim \bigl (E,A \bigr )\]</span>
and <span class="math inline">\(\tilde E\)</span> and <span class="math inline">\(\tilde A\)</span> commute.
</div>



</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Equivalence relation – <strong>RST</strong>. <strong>R</strong>eflexive: <span class="math inline">\(A\sim A\)</span>. <strong>S</strong>ymmetric: <span class="math inline">\(A\sim B\)</span>, then <span class="math inline">\(B\sim A\)</span>. <strong>T</strong>ransitive: <span class="math inline">\(A\sim B\)</span> and <span class="math inline">\(B\sim C\)</span>, then <span class="math inline">\(A\sim C\)</span>.<a href="III.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Paul v. Dooren <a href="https://perso.uclouvain.be/paul.vandooren/publications/VDooren79.pdf">The Computation of Kronecker’s Canonical Form of a Singular Pencil</a><a href="III.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>See the proof of Lemma 2.8 in <em>Kunkel/Mehrmann</em><a href="III.html#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>Dai (1989): <em>Singular Control Systems</em><a href="III.html#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>A so-called particular solution. Btw., <em>all solutions = a particular plus all solutions to the homogeneous problem</em> is the superposition principle for general linear problems.<a href="III.html#fnref5" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-definitions-and-notions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="IV.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DAEs.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
